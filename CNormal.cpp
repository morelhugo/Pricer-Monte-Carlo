//////////////////////////////////////////////////////////////////////
///// Fichier CNormal.cpp : Definition de la classe CNormal  ///////// 
//////////////////////////////////////////////////////////////////////

#include <stdio.h>
#include <cstdlib>
#include <cmath>
#include <ctime>

///////////////////////////////////////////////////////////////////////////

#include "CNormal.hpp"

///////////////////////////////////////////////////////////////////////////

const double CNormal::M_2 = 3.14159265358979323846;

///////////////////////////////////////////////////////////////////////////

CNormal::CNormal(double meani, double variancei)
{
	mean_normal     = meani;
	variance_normal = variancei;
	U               = CUniform(0, 1);
}

///////////////////////////////////////////////////////////////////////////

CNormal::~CNormal()
{
}

///////////////////////////////////////////////////////////////////////////

double CNormal::simule() const
{
	return cos(U.simule() * 2 * M_PI) * sqrt(-2 * log(U.simule()));
}

///////////////////////////////////////////////////////////////////////////

double CNormal::mean() const
{
	return mean_normal ;
}

///////////////////////////////////////////////////////////////////////////

double CNormal::variance() const
{
	return variance_normal ;
}

///////////////////////////////////////////////////////////////////////////

double CNormal::distribution_fonction(double x) const
{
	return (0.5 + 0.5 * erf((x - mean_normal) / (sqrt(variance_normal * 2))));
}

///////////////////////////////////////////////////////////////////////////

